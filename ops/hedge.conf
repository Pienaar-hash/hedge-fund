; /etc/supervisor/conf.d/hedge.conf
; Two processes: hedge-executor, hedge-dashboard

[program:hedge-executor]
command=/bin/bash -lc 'cd /root/hedge-fund && set -a && . ./.env && set +a && exec ./venv/bin/python -m execution.executor_live'
directory=/root/hedge-fund
autostart=true
autorestart=true
startsecs=5
startretries=999
stopsignal=TERM
stdout_logfile=/var/log/hedge-executor.out.log
stderr_logfile=/var/log/hedge-executor.err.log
user=root
environment=PYTHONUNBUFFERED="1",PYTHONPATH="/root/hedge-fund",ENV="prod",USE_FUTURES="1"

[program:hedge-dashboard]
command=/bin/bash -lc 'cd /root/hedge-fund && set -a && . ./.env && set +a && exec ./venv/bin/streamlit run dashboard/app.py --server.port=8501 --server.address=127.0.0.1 --server.headless=true'
directory=/root/hedge-fund
autostart=true
autorestart=true
stopsignal=TERM
stdout_logfile=/var/log/hedge-dashboard.out.log
stderr_logfile=/var/log/hedge-dashboard.err.log
user=root
environment=PYTHONUNBUFFERED="1",PYTHONPATH="/root/hedge-fund",ENV="prod"

[group:hedge]
programs=hedge-executor,hedge-dashboard
