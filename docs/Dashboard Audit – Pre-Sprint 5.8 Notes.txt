---

## ðŸ§­ Dashboard Audit â€“ Pre-Sprint 5.8 Notes

### ðŸ”¹ Overview Page

| Issue                           | Detail                                                                | Recommendation                                                                                                                                                                                                                       |
| ------------------------------- | --------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **NAV / Total Equity mismatch** | Doctor summary reports â‰ˆ $11 843, but dashboard tile shows â‰ˆ $10 760. | Verify `total_equity_usd` calculation path â€” dashboard likely using stale or cached Firestore NAV instead of latest canonical (Doctor reads local). Normalize to canonical helper (`get_nav_snapshot` + `get_treasury`) so UI = CLI. |
| **â€œFreshness FRESHâ€ emphasis**  | Over-prominent in metric block.                                       | Move to tooltip hover over label (e.g. ðŸŸ¢ â€œFresh (1 m ago)â€).                                                                                                                                                                        |
| **Positions = 0**               | Four open positions exist.                                            | Dashboardâ€™s position mirror likely reading stale Firestore `positions/latest`. Validate mirror publisher and ensure UI re-fetch interval â‰¤ 30 s.                                                                                     |
| **Treasury analytics**          | No cost-basis / PnL for reserves.                                     | Add `avg_entry_price` to reserves log (persist in repo). Display per-asset Î”% + USD PnL with colored up/down arrows.                                                                                                                 |

---

### ðŸ”¹ Portfolio KPIs Tile

| Issue                             | Detail                                       | Recommendation                                                                                        |
| --------------------------------- | -------------------------------------------- | ----------------------------------------------------------------------------------------------------- |
| **Peak equity = 3 935 (futures)** | Wrongly using futures NAV as portfolio peak. | Decouple futures-only metrics from global equity tile. Use blended equity curve (futures + treasury). |
| **Reserves 0.13 BTC phantom**     | Likely residue from legacy schema.           | Audit Firestore `positions/latest` and `treasury/latest`; purge old â€œBTC reserveâ€ entry.              |
| **NAV curve empty**               | Missing NAV points.                          | Confirm periodic NAV writer (executor loop) is populating `logs/nav_history.json`; add to Firestore.  |

---

### ðŸ”¹ Execution Tab

| Issue                         | Detail                                            | Recommendation                                                                          |
| ----------------------------- | ------------------------------------------------- | --------------------------------------------------------------------------------------- |
| **â€œFirestore FRESHâ€ too big** | Should be tooltip.                                | Convert all status words (FRESH / STALE / LAG) to hover icons.                          |
| **Router snapshot**           | Duplicate rows per order (new / filled).          | Add de-dupe by `clientOrderId` + latest timestamp.                                      |
| **Signals mirror empty**      | No recent signals logged.                         | Check `execution/signal_generator.py` publisher; ensure last signal â†’ Firestore.        |
| **Trade log blank**           | Expected recent fills missing.                    | Confirm `leaderboard_sync` writes fills â†’ Firestore `fills/latest`.                     |
| **Risk block single entry**   | Stale log.                                        | Validate `risk_autotune` output; may need periodic republish.                           |
| **Backend telemetry JSON**    | Shows flags ONE-WAY; uptime n/a; tooltip missing. | Add uptime field (process start time â†’ now). Render Telemetry status ðŸŸ¢ðŸŸ ðŸ”´ as tooltip. |
| **ZAR conversions**           | Cluttered text.                                   | Move all ZAR conversions to tooltips.                                                   |
| **Positions tab**             | Duplicate of execution data.                      | Merge under Execution tab; single unified layout.                                       |

---

### ðŸ”¹ Router Health Tab

| Issue                        | Detail                       | Recommendation                                                   |
| ---------------------------- | ---------------------------- | ---------------------------------------------------------------- |
| **Average confidence = n/a** | Missing in Firestore mirror. | Add `avg_confidence` field to `publish_router_health()` payload. |

---

### ðŸ”¹ Leaderboard Tab

> **Remove.** Out of scope. Delete tab and related sync modules (save compute + UI space).

---

### ðŸ”¹ Signals Tab

| Issue           | Detail                              | Recommendation                                                              |
| --------------- | ----------------------------------- | --------------------------------------------------------------------------- |
| **Empty table** | Missing Firestore `signals/latest`. | Ensure generator emits signals. If no live strategy, hide tab until active. |

---

### ðŸ”¹ ML Models Tab

| Issue                        | Detail               | Recommendation                                                                                    |
| ---------------------------- | -------------------- | ------------------------------------------------------------------------------------------------- |
| **Retrain last 3 weeks ago** | Cron not running.    | Verify `/etc/cron.daily/retrain_ml.sh` or supervisor process; ensure retrain triggers every 24 h. |
| **Functionality**            | Otherwise excellent. | Maintain layout; add retrain progress + model summary under graph.                                |

---

### ðŸ”¹ Doctor Tab

| Issue                         | Detail           | Recommendation                                                            |
| ----------------------------- | ---------------- | ------------------------------------------------------------------------- |
| **Universe / risk dropdowns** | Wrong values.    | Fetch from canonical risk config.                                         |
| **Run Doctor button error**   | `exit status 1`. | Wrap subprocess call in try/except; stream stdout/stderr to UI for trace. |

---

## ðŸ§© Sprint 5.8 Focus Plan (condensed)

| Priority | Task                                                            |
| -------- | --------------------------------------------------------------- |
| **P1**   | Fix NAV â†” Total Equity consistency + positions mirror accuracy. |
| **P2**   | Tooltip migration (FRESH, ZAR, Telemetry).                      |
| **P3**   | Treasury analytics (cost basis, PnL).                           |
| **P4**   | Execution tab polish (router dedupe, uptime, tooltips).         |
| **P5**   | Drop Leaderboard, merge Positions tab into Execution.           |
| **P6**   | Restore ML retrain cron + display last retrain timestamp.       |
| **P7**   | Stabilize Doctor tab subprocess execution (error-free).         |

---
