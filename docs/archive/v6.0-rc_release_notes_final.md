# üü© **1. v6.0-rc Release Notes (final)**

File: `docs/v6.0-rc_release_notes_final.md`

---

# **GPT-Hedge v6.0-rc ‚Äî Release Notes (Final)**

**Date:** 2025-11-20
**Status:** *Release Candidate (RC)*
**Scope:** v6 runtime, risk engine, router subsystem, intel loop, pipeline shadow/compare, state/telemetry, supervisor topology.

---

## **1. Overview**

v6.0-rc is the first fully contract-complete and audit-clean release of the v6 runtime.
It resolves all RC-blocking issues from the infra_v6.0 audit suite and introduces hardening fixes across VERSION traceability, router auto-apply behaviour, pipeline warmup semantics, state/telemetry invariants, and expanded test coverage.

All five subsystems satisfy their contracts:

* **SC** ‚Äî State Contract
* **TC** ‚Äî Telemetry Contract
* **RC** ‚Äî Risk Contract
* **IC** ‚Äî Intel Contract
* **AC** ‚Äî Router Auto-Tune Contract
* **PC** ‚Äî Pipeline Shadow/Compare Contract

---

## **2. Major Fixes in v6.0-rc**

### **2.1 VERSION Accuracy (Batch 01)**

* VERSION file updated to `v6.0-rc`.
* Executor now falls back to beta preview only when VERSION is missing.
* `engine_version` now appears in:

  * `synced_state.json`
  * `nav.json`
  * `v6_runtime_probe.json`
* Tests updated to assert presence but avoid pinning exact strings.

---

### **2.2 Router Auto-Apply Reliability (Batch 02)**

* Missing/stale allocator state no longer forces permanent ‚Äúdefensive‚Äù mode.
* New staleness window:

  * `ROUTER_AUTOTUNE_V6_RISK_STATE_MAX_AGE_S`
* Structured events logged for:

  * Missing allocator state
  * Corrupt file
  * Stale snapshot
* Auto-apply only blocks when a fresh allocator explicitly reports `"defensive"`.

---

### **2.3 Pipeline Warmup Semantics (Batch 03)**

* Pipeline compare summary now includes:

  * `is_warmup`
  * `warmup_reason`
  * `min_sample_size`
* Warmup triggered when `sample_size < 200`.
* Contract and audit docs updated accordingly.

---

### **2.4 Test + Documentation Hardening (Batch 04)**

* Full alignment of docs with v6 runtime invariant fields.
* Expanded test coverage:

  * State/telemetry invariants
  * Router auto-apply resilience
  * Pipeline warmup behaviour
* Removed resolved issues from known issues.

---

## **3. Remaining Non-Blocking Notes**

* `sync_state` zero-equity Firestore write skip remains as low-severity behaviour.
* Router auto-apply remains gated behind flags until allocation and router health stabilise post-deploy.

---

## **4. Required Flags for Full v6 Runtime**

To activate full v6 behaviour:

```
INTEL_V6_ENABLED=1
RISK_ENGINE_V6_ENABLED=1
PIPELINE_V6_SHADOW_ENABLED=1
ROUTER_AUTOTUNE_V6_ENABLED=1
ROUTER_AUTOTUNE_V6_APPLY_ENABLED=1
FEEDBACK_ALLOCATOR_V6_ENABLED=1
```

Router auto-apply also requires:

```
ROUTER_AUTOTUNE_V6_SYMBOL_ALLOWLIST="BTCUSDT,ETHUSDT,SOLUSDT"
```

---

## **5. Tests / Validation**

All v6-focused tests pass:

```
pytest tests/test_v6_runtime_activation.py
pytest tests/test_executor_state_files.py
pytest tests/test_pipeline_v6_compare_runtime.py
pytest tests/test_router_autotune_apply_v6.py
```

---

## **6. Supervisor Process Topology**

As per `infra_v6.0_repo_topology.md`, supervisor runs exactly:

* `executor_live`
* `sync_state`
* `dashboard`
* `pipeline_shadow_heartbeat`
* `pipeline_compare_service`

---

## **7. Tag Summary**

v6.0-rc is **release-ready**, contract-aligned, and telemetry-complete.
Suitable for Stage deployment ahead of v6.0-final.

---

# üü© **2. v6.0-rc Ops Runbook**

File: `docs/v6.0-rc_ops_runbook.md`

---

# **GPT-Hedge v6.0-rc ‚Äî Ops Runbook**

## **Purpose**

Operational steps for deploying the v6.0-rc runtime on Stage or Prod under Supervisor.

---

## **1. Pre-Deploy Checklist**

### **1.1 Pull latest code**

```
git checkout main
git pull
```

### **1.2 Confirm VERSION**

```
cat VERSION
# Expect: v6.0-rc <date>
```

### **1.3 Check config files**

* `config/risk_limits.json`
* `config/pairs_universe.json`
* `config/runtime.yaml`

Must match venue deployment profile.

---

## **2. Directory Setup**

```
mkdir -p logs/state logs/execution logs/cache logs/pipeline
chmod -R 755 logs
```

Remove legacy v5 caches if present.

---

## **3. Seed Intel (Optional but Recommended)**

```
python3 scripts/expectancy_v6_builder.py
python3 scripts/feedback_allocator_probe_v6.py
```

Confirm the presence of:

* `logs/state/expectancy_v6.json`
* `logs/state/symbol_scores_v6.json`
* `logs/state/risk_allocation_suggestions_v6.json`

---

## **4. Supervisor Deployment**

Place `ops/hedge.conf` into Supervisor:

```
sudo cp ops/hedge.conf /etc/supervisor/conf.d/hedge.conf
sudo supervisorctl reread
sudo supervisorctl update
sudo supervisorctl restart hedge:
```

Processes started:

1. executor
2. sync_state
3. dashboard
4. pipeline_shadow_heartbeat
5. pipeline_compare_service

---

## **5. Runtime Verification**

### **5.1 Check v6 runtime probe**

```
cat logs/state/v6_runtime_probe.json
```

Confirm:

* `engine_version` == VERSION
* v6 flags set correctly

### **5.2 Check synced state**

```
cat logs/state/synced_state.json
```

Confirm:

* `items` list
* `nav` float
* `engine_version`
* `v6_flags`
* `updated_at`

---

## **6. Pipeline Monitoring**

After restart:

* Expect `is_warmup = true` for first ~200 decisions.
* Once sample > threshold ‚Üí warms up: `is_warmup = false`.

Monitor:

```
logs/state/pipeline_v6_compare_summary.json
```

---

## **7. Router Auto-Apply Monitoring**

Check logs:

```
grep router_apply logs/execution/*.jsonl
```

Look for:

* `"router_apply_missing_allocator"`
* `"router_apply_stale_allocator"`
* `"router_apply_fresh_defensive"`
* `"router_apply_applied_policy"`

Enable auto-apply only once allocator + router health stabilise.

---

## **8. sync_state & Firestore**

Ensure:

```
ALLOW_PROD_WRITE=1
ALLOW_PROD_SYNC=1
```

Check Firestore correct population:

* NAV doc populated
* Positions doc populated

---

## **9. Pre-Release Test Suite**

```
pytest \
 tests/test_v6_runtime_activation.py \
 tests/test_executor_state_files.py \
 tests/test_pipeline_v6_compare_runtime.py \
 tests/test_router_autotune_apply_v6.py
```

All must pass (>95% relevance to v6 runtime).