# v6.0 Breaking Changes

1. **State file schema tightened** – `_pub_tick()` (`execution/executor_live.py:3291-3358`) now writes nav/positions/risk/synced payloads using `execution/state_publish.py:77-190`. Any tooling that previously tailed legacy dashboard caches must switch to the `logs/state/*.json` files enumerated in `v6_state_contract.md`.
2. **Firestore writes disabled by default** – `execution/state_publish.py:35-45` and `execution/sync_state.py:34-69` refuse prod writes unless `ALLOW_PROD_WRITE` (executor) and `ALLOW_PROD_SYNC` (sync_state) are set. Legacy pipelines that assumed implicit prod access will fail until the env variables are updated.
3. **Router policy auto-apply gating** – `execution/intel/router_autotune_apply_v6.py:1-155` enforces symbol allowlists, risk-mode guards, and max bias/offset deltas. Custom scripts that mutated router policies directly must now write suggestions to `logs/state/router_policy_suggestions_v6.json` and let the apply helper handle enforcement.
4. **Pipeline telemetry mandatory** – Supervisor now runs `scripts/pipeline_shadow_heartbeat.py` and `scripts/pipeline_compare_service.py` (see `ops/hedge.conf:25-48`). Deployments that omit these daemons will lose `logs/state/pipeline_v6_shadow_head.json` and `logs/state/pipeline_v6_compare_summary.json`, which are required before flipping pipeline flags.
5. **Version tagging** – `_ENGINE_VERSION` (`execution/executor_live.py:116-120`) reads the repo `VERSION` file. Releases must bump this file or all telemetry will show `v0.3.0-testnet-exit 2025-08-24` (current content), confusing dashboards and audits.
6. **No legacy dashboards** – `dashboard/app.py:1-130` only reads local `logs/state/*.json`. External dashboards or scripts that previously talked to "multi_strategy_dashboard" must be pointed at these files (or the Firestore mirror built by `execution/sync_state.py`).

Plan migrations accordingly before promoting v6.0-rc into production.
