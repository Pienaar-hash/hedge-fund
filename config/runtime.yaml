# =======================
#   v7.6 Canonical Runtime Configuration
# =======================

# Runtime environment settings
runtime:
  env: production
  dry_run: false
  enable_dashboard: true
  state_dir: logs/state
  loop_sleep_seconds: 5
  max_loops: null
  logging_level: INFO
  version_file: VERSION

# Service definitions (v7.6 canonical set)
services:
  executor:
    enabled: true
  dashboard:
    enabled: true
  sync_state:
    enabled: true

# Canonical state paths (v7.6 State Contract)
state_paths:
  nav: logs/state/nav.json
  nav_state: logs/state/nav_state.json
  positions_state: logs/state/positions_state.json
  positions_ledger: logs/state/positions_ledger.json
  diagnostics: logs/state/diagnostics.json
  risk_snapshot: logs/state/risk_snapshot.json
  router_health: logs/state/router_health.json
  symbol_scores: logs/state/symbol_scores_v6.json
  factor_diagnostics: logs/state/factor_diagnostics.json
  engine_metadata: logs/state/engine_metadata.json
  kpis_v7: logs/state/kpis_v7.json

# =======================
#   Trading Window
# =======================
trading_window:
  start_utc: 6    # v6.4: expanded from 10 - 06:00 UTC shows +$3/trade
  end_utc: 17     # v6.4: expanded from 16 - capture full EU/US overlap
  # Avoid 01:00-04:00 UTC (Asian session showed -$28/trade avg)
  disabled_days: [5, 6]  # v6.4: disable Sat/Sun (-$40.86 on Sat)

# Router configuration
router:
  # TWAP execution for large orders (v7.4 C1)
  twap:
    enabled: true
    min_notional_usd: 500.0    # minimum gross USD notional to trigger TWAP
    slices: 4                   # number of child orders per TWAP execution
    interval_seconds: 10        # sleep time between slices
  # Slippage model settings (v7.5 B1)
  slippage:
    enabled: true
    ewma_halflife_trades: 50      # EWMA halflife in number of trades
    max_expected_slippage_bps: 15 # optional future veto use
    depth_levels: 5               # order book levels to sample for expected cost
    spread_pause_factor: 1.5      # pause TWAP slice if spread > factor * bucket.max_spread_bps

# Directional bias based on performance data
directional_bias:
  # LONG: +$105 (85% WR), SHORT: -$125 (69% WR)
  # Disable shorts for symbols with negative short PnL
  short_disabled_symbols:
    - LTCUSDT   # -$97 on shorts, +$60 on longs
    - SUIUSDT   # -$24 on shorts, +$14 on longs  
    - LINKUSDT  # -$15 on shorts, +$11 on longs
  long_only_mode: false  # set true to disable all shorts
offpeak:
  max_concurrent_orders: 2
  min_child_notional: 50
priority:
  max_concurrent_orders: 6
  min_child_notional: 25
execution:
  max_transient_retries: 1
  transient_retry_backoff_s: 1.0
  error_cooldown_sec: 60
nav:
  include_assets:
    - USDT
    - USDC
    - BTC
  use_mark_price: true
risk:
  reset_peak_on_testnet: true
  peak_stale_seconds: 600
# Signal gate tunables
signal_gate:
  atr_lookback: 50
  atr_mult: 8.0          # multiplier vs median ATR; increase to allow higher vol
  expectancy_min: -0.10  # minimum rolling expectancy to allow trade
